"use strict";!function(){var g,e,p;function a(){this.init.apply(this,arguments)}g={addHandler:function(t,e,a){t.addEventListener?t.addEventListener(e,a,!1):t.attachEvent?t.attachEvent("on"+e,a):t["on"+e]=a},removeHandler:function(t,e,a){t.removeEventListener?t.removeEventListener(e,a,!1):t.detachEvent?t.detachEvent("on"+e,a):t["on"+e]=null},getEvent:function(t){return t||window.event},getTarget:function(t){return t.target||t.srcElement},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}},e={byId:function(t){return"string"==typeof t?document.getElementById(t):t},byClass:function(t,e){for(var a=[],n=new RegExp("(^| )"+t+"( |$)"),s=this.byTagName("*",e),i=0;i<s.length;i++)n.test(s[i].className)&&a.push(s[i]);return a},byTagName:function(t,e){return(e||document).getElementsByTagName(t)}},p={hasClass:function(t,e){return-1<(" "+t.className+" ").indexOf(" "+e+" ")},addClass:function(t,e){this.hasClass(t,e)||(t.className+=" "+e)},removeClass:function(t,e){t.className=t.className.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)"),"$1").replace(/\s{1,}/g," ")}},a.prototype={init:function(t){this.magWrap=e.byId(t),this.magMain=this.magWrap.children[0],this.mW=this.magMain.offsetWidth,this.mH=this.magMain.offsetHeight,this.magImg=this.magMain.getElementsByTagName("img")[0],this.mImgSrc=this.magImg.getAttribute("data-src"),this.specBox=e.byClass("spec-items",this.magWrap)[0],this.specUl=this.specBox.getElementsByTagName("ul")[0],this.specItem=this.specBox.getElementsByTagName("li"),this.specFn(),this.setEventFn().dragEvent()},setEleFn:function(){var t=this,e="",a=document.createDocumentFragment(),n=document.createDocumentFragment();t.magMain.children[1]||(t.oMD=document.createElement("div"),t.oMD.className="MagnifierDrag",t.oMD.style.cssText="width:"+t.mW/2+"px;height:"+t.mH/2+"px;",t.oMD.innerHTML="&nbsp;",t.oMP=document.createElement("div"),t.oMP.className="MagnifierPop",t.oMP.style.cssText="width:"+t.mW+"px;height:"+t.mH+"px;right:"+(-t.mW-10)+"px;",t.oMI=document.createElement("div"),t.oMI.className="MagnifierImg",t.oMI.style.cssText="width:"+2*t.mW+"px;height:"+2*t.mH+"px;",e='<img style="width:100%;height:100%;" src="'+t.mImgSrc+'">',t.oMI.innerHTML=e,t.oMP.appendChild(t.oMI),a.appendChild(t.oMD),n.appendChild(t.oMP),t.magMain.appendChild(a),t.magWrap.appendChild(n))},removeFn:function(t){var e=this;"IMG"!=g.getTarget(t).nodeName&&(e.magMain.removeChild(e.oMD),e.magWrap.removeChild(e.oMP))},setMousemoveFn:function(t){var e=this,a=document.documentElement.scrollLeft||document.body.scrollLeft,n=document.documentElement.scrollTop||document.body.scrollTop;_x=t.clientX+a-(e.magWrap.getBoundingClientRect().left+a)-e.oMD.offsetWidth/2,_y=t.clientY+n-(e.magMain.getBoundingClientRect().top+n)-e.oMD.offsetHeight/2,_l=e.magMain.offsetWidth-e.oMD.offsetWidth,_t=e.magMain.offsetHeight-e.oMD.offsetHeight,_l2=-(e.oMI.offsetWidth-e.magMain.offsetWidth),_t2=-(e.oMI.offsetHeight-e.magMain.offsetHeight),_x<0?_x=0:_x>_l&&(_x=_l),_y<0?_y=0:_y>_t&&(_y=_t),e.oMD.style.left=_x+"px",e.oMD.style.top=_y+"px",_bigx=_x/_l,_bigy=_y/_t,e.oMI.style.left=_bigx*_l2+"px",e.oMI.style.top=_bigy*_t2+"px"},setEventFn:function(){var e=this;function t(t){switch(events=g.getEvent(t),t.type){case"mouseover":e.setEleFn();break;case"mousemove":e.oMD&&e.setMousemoveFn(t);break;case"mouseout":e.removeFn(t)}}return{dragEvent:function(){g.addHandler(e.magMain,"mouseover",t),g.addHandler(e.magMain,"mousemove",t),g.addHandler(e.magMain,"mouseout",t)}}},specFn:function(){var n,s,i,o=this,a=e.byClass("spe_leftBtn",o.magWrap)[0],l=e.byClass("spe_rightBtn",o.magWrap)[0],c=this.specUl.getElementsByTagName("li")[0].offsetWidth+5,r=o.specItem.length,m=0,d=null,u=null;g.addHandler(o.specUl,"mouseover",function(t){var e=g.getTarget(t),a=0;if("UL"!=e.nodeName){for("IMG"==e.nodeName&&(e=e.parentNode);a<r;a++)o.specItem[a].className="";e.className="on",n=e.getElementsByTagName("img")[0],s=n.getAttribute("data-lsrc"),i=n.getAttribute("data-maxSrc"),o.magImg.setAttribute("src",s),o.magImg.setAttribute("data-src",i),o.mImgSrc=o.magImg.getAttribute("data-src")}}),4<r&&(p.addClass(l,"on"),g.addHandler(o.magWrap,"click",function(t){var e=g.getTarget(t);if(-1<e.className.indexOf("spe_rightBtn")){if(u=++m,r-5<u&&p.removeClass(e,"on"),r-4<u)return m=r-4,!1;o.buttur(o.specUl,{left:-u*c}),p.addClass(a,"on")}if(-1<e.className.indexOf("spe_leftBtn")){if((d=--m)<1&&p.removeClass(e,"on"),d<0)return m=0,!1;o.buttur(o.specUl,{left:-d*c}),p.addClass(l,"on")}}))},buttur:function(t,e){window.clearTimeout(t.timer);var a=this,n=null;for(direc in e){var s=direc.toLowerCase(),i="offset"+s.substr(0,1).toUpperCase()+s.substring(1).toLowerCase(),o=(e[direc]-t[i])/8;o=0<=o?Math.ceil(o):Math.floor(o),t.style[s]=t[i]+o+"px",n+=o}n&&("function"==typeof fnCallback?fnCallback.call(t):t.timer=window.setTimeout(function(){a.buttur(t,e)},20))}},window.MagnifierF=function(t){return new a(t)}}(),window.onload=function(){MagnifierF("MagnifierWrap2")},$(window).scroll(function(){$(document).scrollTop()>$(".parameter_box").offset().top?$(".navfixed").css("display","block").css("height","40"):$(".navfixed").css("height","0").css("display","none");for(var t=0;t<$(".detail_lists").length;t++)window.scrollY>=$(".detail_lists")[t].offsetTop&&($(".nav_box").eq(0).find("li").eq(t).addClass("on").siblings().removeClass("on"),$(".nav_box").eq(1).find("li").eq(t).addClass("on").siblings().removeClass("on"))}),$(".nav_box").eq(1).find("li").on("click",function(){$(this).addClass("on").siblings().removeClass("on");var t=$(this).index();$(".nav_box").eq(0).find("li").eq(t).addClass("on").siblings().removeClass("on")}),$(".nav_box").eq(0).find("li").on("click",function(){$(this).addClass("on").siblings().removeClass("on");var t=$(this).index();$(".nav_box").eq(1).find("li").eq(t).addClass("on").siblings().removeClass("on")}),$(".color_ul li").on("click",function(){$(this).addClass("on").siblings().removeClass("on")}),$(".btn-add").click(function(){var t=$("#buy_num").val()-0;t++,$("#buy_num").val(t)}),$(".btn-reduce").click(function(){var t=$("#buy_num").val()-0;--t<=1&&(t=1),$("#buy_num").val(t)}),$("#buy_num").keyup(function(){$("#buy_num").val()<=1&&$("#buy_num").val(1)});var data=decodeURI(location.search),uid=data.slice(1);function getmessage(){$.ajax({type:"post",url:"../api/details.php",async:!0,data:{id:uid,mode:"get"},success:function(t){var e=JSON.parse(t).map(function(t){return'<li class="appraise_li">\n\t\t\t\t\t\t\t<div class="a_li_t1">\n\t\t\t\t\t\t\t\t<div class="appr_cons">'.concat(t.content,'</div>\n\t\t\t\t\t\t\t\t\t<div class="appr_time">').concat(t.dataline,'</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="a_li_t2">\n\t\t\t\t\t\t\t\t\t*****\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="a_li_t3">\n\t\t\t\t\t\t\t\t\t<img src="https://ecimg.happigo.com/resource/web/images/user_center/user_center_img4.jpg"><br>\n\t\t\t\t\t\t\t\t\t\t<span>').concat(t.user,"</span></div>\n\t\t\t\t\t\t</li>")}).join("");$("#comments_list").html(e)}})}$.ajax({type:"post",url:"../api/details.php",async:!1,data:{id:uid},success:function(t){var e=JSON.parse(t);$(".price_now").html("¥ "+e.price),$(".costprice").html("￥ "+e.costprice),$(".detail_tit").html(e.title),$(".sort1").html(e.sort1),$(".sort2").html(e.sort2);var a=e.smallimg.split(",");$(".MagTargetImg").attr("src",a[0]);var n=a.map(function(t){return'<li><img src="'.concat(t,'" data-lsrc="').concat(t,'" data-maxSrc="').concat(t,'" /></li>')}).join("");$(".smallimglist").html(n),$(".smallimglist li").eq(0).attr("class","on")}}),getmessage(),$("#send").click(function(){var t=new Date;getcookie?$("#creatMessage").val().trim()?$.ajax({type:"post",url:"../api/details.php",async:!0,data:{id:uid,mode:"submit",message:$("#creatMessage").val(),user:getcookie,time:t.toLocaleString()},success:function(t){1==t&&(alert("评论成功"),$("#creatMessage").val(""),getmessage())}}):alert("评论不能为空"):alert("你还未登录，不能评论")}),$(".a_add_car").click(function(){getcookie?$.ajax({type:"post",url:"../api/carts.php",async:!0,data:{id:uid,user:getcookie,type:"add",num:$("#buy_num").val()},success:function(t){$.ajax({type:"post",url:"../api/carts.php",async:!0,data:{user:getcookie},success:function(t){var e=JSON.parse(t);$(".car_num").html(e.length)}})}}):alert("你还未登录！")});