"use strict";var thekeyword=(data=decodeURI(location.search)).slice(1).slice(11);!function(r){var v,a,s={leng:6,activeClass:"page-active",firstPage:"首页",lastPage:"末页",prv:"«",next:"»",clickBack:function(){console.log(l)}};r.fn.extend({page:function(t){return a=t,v=r.extend(s,t),this.each(function(){var e=r(this),t="",a="",s=v.leng;if(1<s&&s<10)for(t='<li><a href="javascript:" class="'+v.activeClass+'">1</a></li>',i=2;i<s+1;i++)a+='<li><a href="javascript:">'+i+"</a></li>";else if(9<s)for(t='<li><a href="javascript:" class="'+v.activeClass+'">1</a></li>',i=2;i<10;i++)a+='<li><a href="javascript:">'+i+"</a></li>";else t='<li><a href="javascript:" class="'+v.activeClass+'">1</a></li>';function l(){var t=parseInt(r("."+v.activeClass).html()),a=t-4,s="";for(i=0;i<9;i++)s+='<li><a href="javascript:" class="">'+(a+i)+"</a></li>";e.find("ul").html(s),e.find("ul li").eq(4).find("a").addClass(v.activeClass)}function c(t){var a="";if(8<s)for(i=0;i<9;i++)a+='<li><a href="javascript:" class="">'+(i+1)+"</a></li>";else for(i=0;i<s;i++)a+='<li><a href="javascript:" class="">'+(i+1)+"</a></li>";e.find("ul").html(a),e.find("ul li").eq(t).find("a").addClass(v.activeClass)}function n(t){var a="";if(8<s){for(i=s-8;i<s+1;i++)a+='<li><a href="javascript:" class="">'+i+"</a></li>";e.find("ul").html(a),e.find("ul li").eq(t).find("a").addClass(v.activeClass)}else{for(i=0;i<s;i++)a+='<li><a href="javascript:" class="">'+(i+1)+"</a></li>";e.find("ul").html(a),e.find("ul li").eq(t).find("a").addClass(v.activeClass)}}e.html('<div class="next" style="float:right">'+v.next+'</div><div class="last" style="float:right">'+v.lastPage+'</div><ul class="pagingUl">'+t+a+'</ul><div class="first" style="float:right">'+v.firstPage+'</div><div class="prv" style="float:right">'+v.prv+"</div>"),e.on("click",".next",function(){var t=parseInt(r("."+v.activeClass).html());if(t==s)return!1;t==s||(s-5<t&&t<s?r("."+v.activeClass).removeClass(v.activeClass).parent().next().find("a").addClass(v.activeClass):0<t&&t<6?r("."+v.activeClass).removeClass(v.activeClass).parent().next().find("a").addClass(v.activeClass):(r("."+v.activeClass).removeClass(v.activeClass).parent().next().find("a").addClass(v.activeClass),l())),v.clickBack(t+1)}),e.on("click",".prv",function(){var t=parseInt(r("."+v.activeClass).html());if(1==t)return!1;s-5<t&&t<s+1?r("."+v.activeClass).removeClass(v.activeClass).parent().prev().find("a").addClass(v.activeClass):1<t&&t<6?r("."+v.activeClass).removeClass(v.activeClass).parent().prev().find("a").addClass(v.activeClass):(r("."+v.activeClass).removeClass(v.activeClass).parent().prev().find("a").addClass(v.activeClass),l()),v.clickBack(t-1)}),e.on("click",".first",function(){if(1==parseInt(r("."+v.activeClass).html()))return!1;r("."+v.activeClass).removeClass(v.activeClass).parent().prev().find("a").addClass(v.activeClass),c(0),v.clickBack(1)}),e.on("click",".last",function(){var t=s;if(parseInt(r("."+v.activeClass).html())==s)return!1;9<s?(r("."+v.activeClass).removeClass(v.activeClass).parent().prev().find("a").addClass(v.activeClass),n(8)):(r("."+v.activeClass).removeClass(v.activeClass).parent().prev().find("a").addClass(v.activeClass),n(s-1)),v.clickBack(t)}),e.on("click","li",function(){var t=r(this),a=parseInt(t.find("a").html());if(a==parseInt(r("."+v.activeClass).html()))return!1;9<s?s-5<a&&a<s+1?(r("."+v.activeClass).removeClass(v.activeClass),t.find("a").addClass(v.activeClass),n(8-(s-a))):0<a&&a<5?(r("."+v.activeClass).removeClass(v.activeClass),t.find("a").addClass(v.activeClass),c(a-1)):(r("."+v.activeClass).removeClass(v.activeClass),t.find("a").addClass(v.activeClass),l()):(r("."+v.activeClass).removeClass(v.activeClass),t.find("a").addClass(v.activeClass)),v.clickBack(a)})})},setLength:function(t){a.leng=t,r(this).html(""),r(this).unbind(),r(this).page(a)}})}(jQuery);var data,str=(data=decodeURI(location.search)).slice(1),ipage=1,order="",type="",istrue1=!1,istrue2=!1,keywork="";thekeyword&&(keywork=thekeyword,$("#list_search").val(thekeyword));var min="",max="",num=8,pagetotal="";function requestData(e,i,t,a,s,l,c){$.ajax({type:"post",url:"../api/list.php",async:!1,data:{page:e,num:i,type:t,istrue:a,keywork:s,min:l,max:c},success:function(t){var a=JSON.parse(t),s=a.goodslist.map(function(t){return'<li data-id="'.concat(t.id,'">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class="list_img">\n\t\t\t\t\t\t\t\t<a class="sl_goods_img" href="###" title="').concat(t.title,'">\n\t\t\t\t\t\t\t\t\t<img src="').concat(t.img,'" title="').concat(t.title,'"> </a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="list_text">\n\t\t\t\t\t\t\t\t<div class="sl_price">\n\t\t\t\t\t\t\t\t\t\t<span style="color:#DF0010">').concat(t.price,"</span>\n\t\t\t\t\t\t\t\t\t\t<del>").concat(t.costprice,'</del>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<a class="sl_title" href="###" title="').concat(t.title,'">').concat(t.title,'</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="sl_sales">\n\t\t\t\t\t\t\t\t\t\t<span>销量:').concat(t.sales,"</span>\n\t\t\t\t\t\t\t\t<div>\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>")}).join("");$(".list_ul").html(s),$(".listtotal").html(a.total),$(".nowpage").html(e),$(".pagetotal").html(Math.ceil(a.total/i)),pagetotal=Math.ceil(a.total/i)}})}function resendRequest(){requestData(ipage,num,type,order,keywork,min,max),$(".pageTest").page({leng:pagetotal,activeClass:"activP",clickBack:function(t){requestData(t,num,type,order,keywork,min,max)}}),$(".pageTest").setLength(pagetotal)}resendRequest(),$("#priceBtn").click(function(){order=istrue1=!istrue1,console.log(istrue1),istrue1?$("#priceBtn").val("价格降序"):$("#priceBtn").val("价格升序"),type="price",ipage=1,resendRequest()}),$("#salesBtn").click(function(){order=istrue2=!istrue2,console.log(istrue1),istrue1?$("#salesBtn").val("销量降序"):$("#salesBtn").val("销量升序"),type="sales",ipage=1,resendRequest()}),$("#defaultBtn").click(function(){console.log(1),ipage=1,type="price",order="",min=$("#priceL").val(),max=$("#priceR").val(),resendRequest()}),$("#searchBtn").click(function(){$("#list_search").val().trim()&&(ipage=1,type="price",order="",min=$("#priceL").val(),max=$("#priceR").val(),keywork=$("#list_search").val(),resendRequest())}),$("#confirmBtn").click(function(){""!=$("#priceL").val()&&""!=$("#priceR").val()?(keywork=$("#list_search").val(),min=$("#priceL").val(),max=$("#priceR").val(),type="price",ipage=1,resendRequest()):alert("请输入完整的价格区间")}),$(".list_ul").on("click","li",function(){window.location.href="details.html?"+$(this).attr("data-id")});